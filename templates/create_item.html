<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Items</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss/dist/tailwind.min.css">
</head>
<body class="bg-gray-100 p-6">
    <div class="max-w-3xl mx-auto bg-white rounded-lg overflow-hidden shadow-lg">
        <div class="px-6 py-4">
            <h1 class="text-2xl font-bold mb-4">Items</h1>
            
            <table class="w-full border-collapse">
                <thead>
                    <tr>
                        <th class="px-4 py-2 bg-gray-200 border-b">Name</th>
                        <th class="px-4 py-2 bg-gray-200 border-b">ID</th>
                        <th class="px-4 py-2 bg-gray-200 border-b">Rarity</th>
                        <th class="px-4 py-2 bg-gray-200 border-b">Properties</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in items %}
                    <tr>
                        <td class="px-4 py-2 border-b">{{ item['item_name'] }}</td>
                        <td class="px-4 py-2 border-b">{{ item['item_id'] }}</td>
                        <td class="px-4 py-2 border-b">{{ item['item_rarity'] }}</td>
                        <td class="px-4 py-2 border-b">{{ item['item_properties'] }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <div class="mt-4">
                <h2 class="text-lg font-bold mb-2">Add New Item</h2>
                <form id="itemForm">
                    <div class="mb-2">
                        <label for="newItemName" class="block font-medium mb-1">Name</label>
                        <input type="text" id="newItemName" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Enter item name">
                    </div>
                    <div class="mb-2">
                        <label for="newItemId" class="block font-medium mb-1">ID (eg:connsumable001)</label>
                        <input type="text" id="newItemId" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Enter item ID">
                    </div>
                    <div class="mb-2">
                        <label for="newItemRarity" class="block font-medium mb-1">Rarity</label>
                        <input type="text" id="newItemRarity" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline" placeholder="Enter item rarity">
                    </div>
                    <div class="mb-2">
                        <label class="block font-medium mb-1">Properties</label>
                        <div id="propertyFields">
                            <input type="text" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2" placeholder="Enter item property">
                        </div>
                        <button type="button" class="bg-green-500 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline mt-2" onclick="addPropertyField()">Add Another Property</button>
                    </div>
                    <button type="button" class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline" onclick="addItem()">Add Item</button>

                    
                </form>
            </div>
        </div>
    </div>

    <script>
function addItem() {
    const name = document.getElementById('newItemName').value;
    const id = document.getElementById('newItemId').value;
    const rarity = document.getElementById('newItemRarity').value;

    // Get all property inputs
    const propertyInputs = document.querySelectorAll('#propertyFields input');
    const properties = Array.from(propertyInputs).map(input => input.value).filter(value => value);

    if (name && id && rarity && properties) {
        fetch('/items_api/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ 
                item_name: name, 
                item_id: id,
                item_rarity: rarity,
                item_properties: properties
            })
        })
        .then(response => response.json())
        .then(data => {
            // Reload the page to show the new item
            location.reload();
        })
        .catch(error => {
            alert(`Error: ${error}`);
        });
    } else {
        alert('Please fill in all fields.');
    }
}

function addPropertyField() {
    const propertyFields = document.getElementById('propertyFields');
    const newField = document.createElement('input');
    newField.type = 'text';
    newField.placeholder = 'Enter item property';
    newField.className = 'shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline mb-2';
    propertyFields.appendChild(newField);
}

    </script>
</body>
</html>
